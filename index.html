<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Storia della Scuola Paterna Maschile — ascolta il racconto e scopri il progetto. (IT/EN)" />
  <meta name="theme-color" content="#0f172a" />
  <title>Scuola Paterna Maschile</title>

  <!-- Preload hero for faster LCP on phones -->
  <link rel="preload" as="image" href="images/hero-1200.webp" imagesrcset="images/hero-1200.webp 1200w, images/hero-2400.webp 2400w" imagesizes="100vw">

  <style>
    :root{
      --bg:#0b1020;       /* page background */
      --fg:#0f172a;       /* hero overlay base */
      --text:#0b1020;
      --white:#ffffff;
      --brand:#facc15;    /* gold accent */
      --muted:#94a3b8;    /* slate-400-ish */
      --ring:#60a5fa;     /* focus ring */
    }
    /* Base */
    html,body{margin:0;padding:0}
    body{
      font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:#111827;
      background:#fff;
      -webkit-font-smoothing:antialiased;
      text-rendering:optimizeLegibility;
    }
    a{color:inherit}
    button{font:inherit}
    .container{max-width:64rem;margin-inline:auto;padding:0 1rem}

    /* Header */
    .topbar{
      position:sticky;top:0;z-index:10;
      backdrop-filter:saturate(130%) blur(8px);
      background:rgba(255,255,255,.7);
      border-bottom:1px solid #e5e7eb;
    }
    .brand{font-weight:700; letter-spacing:.2px}
    .lang{display:flex; gap:.5rem}
    .chip{
      border:1px solid #e5e7eb; background:#fff;
      padding:.35rem .7rem; border-radius:999px; font-size:.9rem;
      cursor:pointer; transition:background .2s ease, transform .06s ease;
    }
    .chip:focus{outline:none; box-shadow:0 0 0 3px var(--ring)}
    .chip[aria-pressed="true"]{background:#fde68a; border-color:#fcd34d}
    .chip:active{transform:translateY(1px)}

    /* Hero */
    .hero{position:relative; min-height:68vh; display:grid; place-items:end; isolation:isolate}
    .hero-media{position:absolute; inset:0; overflow:hidden}
    .hero-media img{
      position:absolute; inset:0; width:100%; height:100%; object-fit:cover;
    }
    .hero-overlay{
      position:absolute; inset:0;
      background: linear-gradient(to bottom, rgba(0,0,0,.45), rgba(0,0,0,.25) 50%, rgba(0,0,0,.55));
    }
    .hero-content{position:relative; z-index:1; padding:2.5rem 1rem 2.75rem}
    .tag{color:#e5e7eb; text-transform:uppercase; letter-spacing:.15em; font-size:.75rem}
    h1{color:#fff; font-weight:800; font-size:clamp(1.75rem, 4vw, 2.75rem); line-height:1.15; margin:.5rem 0}
    .sub{color:#e5e7eb; max-width:40rem}
    .cta{
      display:inline-flex; align-items:center; gap:.5rem;
      margin-top:1rem; padding:.75rem 1rem; border-radius:12px;
      background:var(--brand); color:#3b2900; font-weight:600; text-decoration:none;
      box-shadow:0 10px 25px rgba(0,0,0,.12);
      transition:transform .15s ease, filter .15s ease;
    }
    .cta:focus{outline:none; box-shadow:0 0 0 3px var(--ring)}
    .cta:hover{filter:saturate(110%)}
    .cta:active{transform:translateY(1px)}

    /* Audio section */
    .section{padding:2rem 1rem}
    .card{
      background:#fff; border:1px solid #e5e7eb; border-radius:16px;
      padding:1rem; box-shadow:0 8px 24px rgba(0,0,0,.06);
    }
    .muted{color:var(--muted); font-size:.9rem}
    audio{width:100%}
    .sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}

    /* Motion preferences */
    @media (prefers-reduced-motion: reduce){
      .cta, .chip{transition:none}
    }
  </style>
</head>
<body>
  <!-- Top bar -->
  <header class="topbar">
    <div class="container" style="display:flex; align-items:center; justify-content:space-between; padding:.8rem 1rem;">
      <div class="brand">Scuola Paterna Maschile</div>
      <div class="lang" role="group" aria-label="Language">
        <button id="langIt" class="chip" aria-pressed="true" aria-label="Italiano">IT</button>
        <button id="langEn" class="chip" aria-pressed="false" aria-label="English">EN</button>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero" id="home" aria-label="Hero">
    <div class="hero-media">
      <!-- Responsive hero image: WebP with JPEG fallback -->
      <picture>
        <source type="image/webp" srcset="images/hero-1200.webp 1200w, images/hero-2400.webp 2400w" sizes="100vw">
        <img src="images/hero-1200.jpg" alt="Esterno della scuola rurale storica" width="2400" height="1400" fetchpriority="high" decoding="async">
      </picture>
      <div class="hero-overlay" aria-hidden="true"></div>
    </div>

    <div class="hero-content container">
      <div class="tag" data-i18n="tagline">Storia • Cultura • Comunità</div>
      <h1 data-i18n="title">Scuola Paterna</h1>
      <p class="sub" data-i18n="subtitle">Scuola di prossimità, un luogo di istruzione, assistenza e socialità.</p>
      <a class="cta" href="#listen" data-i18n="cta">Ascolta il racconto</a>
    </div>
  </section>

  <!-- Audio -->
  <section class="section" id="listen" aria-labelledby="listen-h">
    <div class="container">
      <h2 id="listen-h" class="sr-only">Ascolta</h2>
      <div class="card">
        <p class="muted" data-i18n="audioNote">Ascolta il racconto completo (5 min).</p>
        <audio id="story" controls preload="none" aria-label="Ascolta la storia">
          <source id="storySrc" src="audio/storia-it.mp3" type="audio/mpeg">
          <!-- Optional: captions if you have them
          <track id="storyTrack" kind="captions" src="captions/storia-it.vtt" srclang="it" label="Italiano">
          -->
          Il tuo browser non supporta l'elemento audio.
        </audio>
      </div>
    </div>
  </section>

  <!-- Minimal i18n (IT default in HTML, EN in JS) -->
  <script>
    // English strings (Italian lives in the HTML for progressive enhancement)
    const STR = {
      en: {
        tagline: "History • Culture • Community",
        title: "Scuola Paterna",
        subtitle: "Local school, a place of education, assistance and socialization.",
        cta: "Listen to the story",
        audioNote: "Listen to the full story (5 min)."
      }
    };

    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));

    function setLang(lang){
      const useEn = (lang === 'en');
      document.documentElement.lang = useEn ? 'en' : 'it';

      $$('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (!el.dataset.original) el.dataset.original = el.textContent;
        el.textContent = useEn ? (STR.en[key] || el.dataset.original) : el.dataset.original;
      });

      // Swap audio source (keep same duration info in text)
      const audio = $('#story');
      const srcEl = $('#storySrc');
      if (audio && srcEl) {
        const newSrc = useEn ? 'audio/story-en.mp3' : 'audio/storia-it.mp3';
        if (srcEl.getAttribute('src') !== newSrc) {
          srcEl.setAttribute('src', newSrc);
          audio.load(); // apply new source
        }
      }

      // Toggle pressed state
      $('#langIt').setAttribute('aria-pressed', String(!useEn));
      $('#langEn').setAttribute('aria-pressed', String(useEn));
    }

    // Startup
    window.addEventListener('DOMContentLoaded', () => {
      // Cache originals
      $$('[data-i18n]').forEach(el => { if (!el.dataset.original) el.dataset.original = el.textContent; });

      // Default Italian
      setLang('it');

      // Buttons
      $('#langIt').addEventListener('click', () => setLang('it'));
      $('#langEn').addEventListener('click', () => setLang('en'));
    });
  </script>
</body>
</html>